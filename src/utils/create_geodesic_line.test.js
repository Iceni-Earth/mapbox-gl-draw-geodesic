import createGeodesicLine from './create_geodesic_line';

const STEPS = 8;
const COORDINATES = [[-40, 37.5], [40, 37.5], [40, 30], [-40, -30], [-40, -37.5], [40, -37.5]];
const ANTIMERIDIAN_COORDINATES = COORDINATES.map((x) => [x[0] + 180, x[1]]);

describe('createGeodesicLine', () => {
  it('returns a line', () => {
    const expectedResult = [
      [-40.00000000000001, 37.50000000000001],
      [-29.640181847974322, 41.04294366518809],
      [-18.284925381704838, 43.56424149208077],
      [-6.187586058787172, 44.88054289444877],
      [6.187586058787172, 44.88054289444877],
      [18.28492538170483, 43.564241492080775],
      [29.640181847974315, 41.04294366518808],
      [40.00000000000001, 37.50000000000001],
      [40, 36.42857142857143],
      [40.00000000000001, 35.357142857142854],
      [40, 34.285714285714285],
      [40, 33.214285714285715],
      [40.00000000000001, 32.142857142857146],
      [39.99999999999999, 31.071428571428566],
      [40.00000000000001, 29.999999999999996],
      [27.167509670543375, 22.299081916471977],
      [15.748721276100815, 13.700764508258576],
      [5.159313901608258, 4.617798568750278],
      [-5.159313901608256, -4.617798568750275],
      [-15.7487212761008, -13.700764508258565],
      [-27.167509670543375, -22.299081916471977],
      [-40.00000000000001, -29.999999999999996],
      [-40.00000000000001, -31.071428571428566],
      [-40, -32.142857142857146],
      [-40.00000000000001, -33.214285714285715],
      [-40, -34.285714285714285],
      [-40.00000000000001, -35.357142857142854],
      [-40, -36.42857142857143],
      [-40.00000000000001, -37.50000000000001],
      [-29.640181847974322, -41.04294366518809],
      [-18.284925381704838, -43.56424149208077],
      [-6.187586058787172, -44.88054289444877],
      [6.187586058787172, -44.88054289444877],
      [18.28492538170483, -43.564241492080775],
      [29.640181847974315, -41.04294366518808],
      [40.00000000000001, -37.50000000000001]
    ];
    const result = createGeodesicLine(COORDINATES, STEPS);
    expect(result).toBeDeepCloseTo(expectedResult);
  });

  it('returns a line crossing antimeridian', () => {
    const expectedResult = [
      [140, 37.49999999999999],
      [150.3598181520257, 41.04294366518809],
      [161.71507461829515, 43.564241492080775],
      [173.8124139412128, 44.88054289444877],
      [180, 44.88054289444877],
      [186.18758605878716, 44.88054289444877],
      [198.28492538170482, 43.564241492080775],
      [209.6401818479743, 41.04294366518809],
      [219.99999999999997, 37.5],
      [220, 36.42857142857143],
      [219.99999999999997, 35.357142857142854],
      [220, 34.285714285714285],
      [219.99999999999997, 33.214285714285715],
      [220, 32.142857142857146],
      [219.99999999999997, 31.071428571428566],
      [220, 29.999999999999993],
      [207.16750967054335, 22.299081916471977],
      [195.74872127610078, 13.700764508258574],
      [185.15931390160824, 4.6177985687502785],
      [180, 1.4654943925052066e-14],
      [174.84068609839173, -4.617798568750274],
      [164.25127872389922, -13.700764508258567],
      [152.83249032945662, -22.299081916471977],
      [140, -29.999999999999993],
      [140, -31.071428571428566],
      [140, -32.142857142857146],
      [140, -33.214285714285715],
      [140, -34.285714285714285],
      [140, -35.357142857142854],
      [140, -36.42857142857143],
      [140, -37.49999999999999],
      [150.3598181520257, -41.04294366518809],
      [161.71507461829515, -43.564241492080775],
      [173.8124139412128, -44.88054289444877],
      [180, -44.88054289444877],
      [186.18758605878716, -44.88054289444877],
      [198.28492538170482, -43.564241492080775],
      [209.6401818479743, -41.04294366518809],
      [219.99999999999997, -37.5]
    ];
    const result = createGeodesicLine(ANTIMERIDIAN_COORDINATES, STEPS);
    expect(result).toBeDeepCloseTo(expectedResult);
  });
});